% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lm.mle.R
\name{lm.mle}
\alias{lm.mle}
\title{Linear Regression via MLE}
\usage{
lm.mle(
  formula,
  data,
  subset,
  ln.var.v = NULL,
  technique = c("nr"),
  vcetype = c("aim"),
  lmtol = 1e-05,
  reltol = 1e-12,
  maxit = 199,
  report = 1,
  trace = 1,
  print.level = 3,
  digits = 4,
  threads = 8,
  only.data = FALSE,
  ...
)
}
\arguments{
\item{formula}{an object of class \code{formula} specifying the regression:
typically \code{y ~ x1 + ...}, where \code{y} is the dependent variable and
the \code{x}'s are regressors.}

\item{data}{an optional \code{data.frame} containing the variables referenced in
\code{formula}. If not found in \code{data}, variables are taken from
\code{environment(formula)}.}

\item{subset}{an optional logical or numeric vector specifying the subset of observations
to be used in estimation.}

\item{ln.var.v}{optional one-sided formula; e.g. \code{ln.var.v ~ z1 + z2}. When provided,
the error variance is modeled as \eqn{\log(\sigma_i^2) = w_i^\top \gamma_v}.
If \code{NULL}, the variance is homoskedastic.}

\item{technique}{character vector specifying the preferred optimization routine(s) in order of
preference. Recognized keywords (for future implementation) include \code{"nr"}
(Newton–Raphson), \code{"bhhh"}, \code{"nm"} (Nelder–Mead), \code{"bfgs"},
and \code{"cg"}. Default is \code{"nr"}. This scaffold records but does not
execute the chosen routine.}

\item{vcetype}{character specifying the variance–covariance estimator type:
\code{"aim"} for (approximate) information matrix or \code{"opg"} for the outer
product of gradients. Default is \code{"aim"} (recorded; not yet computed here).}

\item{lmtol}{numeric. Convergence tolerance based on scaled gradient (when applicable).
Default \code{1e-5}.}

\item{reltol}{numeric. Relative convergence tolerance for likelihood maximization.
Default \code{1e-12}.}

\item{maxit}{integer. Maximum number of iterations for the optimizer. Default \code{199}.}

\item{report}{integer. Verbosity level for reporting progress (if implemented). Default \code{1}.}

\item{trace}{integer. Trace level for optimization (if implemented). Default \code{1}.}

\item{print.level}{integer. Printing level for summaries. Default \code{3}.}

\item{digits}{integer. Number of digits for printing. Default \code{4}.}

\item{threads}{integer. Number of threads (placeholder for parallel implementations). Default \code{8}.}

\item{only.data}{logical. If \code{TRUE}, returns only constructed data/matrices without
estimation. Default \code{FALSE}.}

\item{...}{additional arguments reserved for future methods (e.g., bounds, penalties).}
}
\value{
A list of class \code{"lm.mle"} containing:
\itemize{
  \item{\code{call}}{ — matched call.}
  \item{\code{terms}}{ — model terms.}
  \item{\code{model}}{ — list with constructed components: \code{y}, \code{X}, \code{Zv}.}
  \item{\code{coef}}{ — named numeric vector of parameter estimates (placeholder).}
  \item{\code{vcov}}{ — variance–covariance matrix (placeholder).}
  \item{\code{loglik}}{ — log-likelihood at the solution (placeholder).}
  \item{\code{esample}}{ — logical vector indicating the estimation sample.}
  \item{\code{controls}}{ — list of control parameters and settings.}
}
}
\description{
\code{lm.mle} fits a linear regression model by maximum likelihood, allowing
for optional multiplicative heteroskedasticity in the disturbance variance via
a log-linear specification provided through \code{ln.var.v}.
}
\details{
Linear Model by Maximum Likelihood (with optional heteroskedasticity)


The model is
\deqn{y_i = x_i^\top \beta + \varepsilon_i,\quad \varepsilon_i \sim \mathcal{N}(0, \sigma_i^2).}
When \code{ln.var.v} is supplied, the variance follows
\deqn{\log(\sigma_i^2) = w_i^\top \gamma_v,}
otherwise \eqn{\sigma_i^2 = \sigma^2} is constant (homoskedastic).

This scaffold:
\itemize{
  \item Builds the model frame and \code{X}, \code{y}.
  \item Builds \code{Zv} for the log-variance index when \code{ln.var.v} is provided.
  \item Returns a structured object with placeholders for \code{coef}, \code{vcov}, \code{loglik}.
}
Insert your MLE engine to estimate \eqn{\beta}, and (optionally) \eqn{\sigma^2} or
\eqn{\gamma_v}; compute standard errors via AIM/OPG as required by \code{vcetype}.
}
\examples{
\dontrun{
  set.seed(42)
  n  <- 300
  x1 <- rnorm(n); x2 <- runif(n)
  y  <- 1 + 2*x1 - 1.5*x2 + rnorm(n, sd = 0.7)
  df <- data.frame(y, x1, x2, z1 = rnorm(n))

  # Homoskedastic MLE scaffold
  fit0 <- lm.mle(y ~ x1 + x2, data = df)
  str(fit0)

  # Heteroskedastic variance via log-linear index
  fit1 <- lm.mle(
    y ~ x1 + x2, data = df,
    ln.var.v = ~ z1,
    technique = c("nr"), vcetype = "aim"
  )
  str(fit1)

  # Design matrices only (no estimation)
  mats <- lm.mle(y ~ x1 + x2, data = df, ln.var.v = ~ z1, only.data = TRUE)
  names(mats$model)
}

}
\keyword{heteroskedasticity}
\keyword{maximum-likelihood}
\keyword{regression}
